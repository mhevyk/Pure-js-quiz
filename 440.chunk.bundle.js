"use strict";(self.webpackChunkquiz_game_new=self.webpackChunkquiz_game_new||[]).push([[440],{3440:(e,t,n)=>{n.r(t),n.d(t,{initFormComponents:()=>z});var i=n(5745),s=n(3658),a=n(3845),l=n(6117),o=n(2048);const r=document.querySelector(".form__add-group"),c=r.group;function d(){const e=c.value.trim(),{EMPTY_INPUT:t,GROUP_ALREADY_EXISTS:n}=o.dc;e?i.T.groups.includes(e)?(0,o.KB)(c,n(e)):(0,o.TK)(c):(0,o.KB)(c,t)}function u(){const e=c.value.trim();(0,s.vX)((0,l.Pj)(e),(()=>{i.T.addGroup(e),i.T.save(),(0,s.Fx)(r),(0,a.K)()}))}function h(e){(0,s.mv)(e.target,u)}const m=document.querySelector(".form__delete-group");function p(){const e=(0,s.ZN)(m.groups),t=(0,l.XD)(e);(0,s.vX)(t,(()=>function(e){i.T.removeGroup(e),i.T.print(),i.T.save(),(0,s.Fx)(m),(0,a.K)()}(e)))}function f(e){(0,s.mv)(e.target,p)}const{EMPTY_INPUT:g,CONTAINS_COMMA:v,SAME_INPUT_VALUES:_}=o.vG;function E(e){const t=[e.word,...e.querySelectorAll('[name="translate"]')],n=t.map((e=>e.value)).filter(Boolean).reduce(((e,t)=>(e[t]=e[t]+1||1,e)),{});t.forEach((e=>function(e,t){const n=e.value.trim(),i=e.form.word,s="word"===e.name;n?n.includes(",")?(0,o.KB)(e,v(s)):t>1?(0,o.KB)(e,_(i.value===n)):(0,o.TK)(e):(0,o.KB)(e,g(s))}(e,n[e.value])))}const L=document.querySelector("#add-translate-reset"),T=document.querySelector(".additional__translates-container");function S(){const e=document.querySelector(".form__add-single-word"),t=e.querySelector('[name="translate"]');l.O3.id=1,l.O3.count=1,(0,s.TL)(t),(0,o.zS)(e,"[data-reset]"),(0,s.yy)(T),(0,s.G9)(l.O3.count)}L.addEventListener("click",(function(){(0,s.vX)(l.L0,S)}));const y=document.querySelector(".form__add-single-word");function b(){const e=y.word,t=y.querySelectorAll('[name="translate"]'),n=y.groups,o=e.value.trim(),r=Array.from(t,(e=>e.value.trim())),c=(0,s.ZN)(n).trim(),d=(0,l.ib)(o,r,c);(0,s.vX)(d,(()=>{i.T.addOne({word:o,translates:r,group:c}),i.T.print(),i.T.save(),(0,s.Fx)(y),(0,a.K)()}))}function A(e){"text"===e.target.type&&E(y)}function x(e){(0,s.mv)(e.target,b)}const C=document.querySelector(".additional__translates-container");function w(){const e=l.O3.id+1,t=`\n        <label class='form__label row' data-delete-id="${e}">\n            <div class='input-delete__container'>\n                <i class='input-delete fa fa-trash' aria-hidden='true' data-delete-id='${e}'></i>\n            </div>\n            <input type='text' class='text-input' name='translate' placeholder='Переклад' maxlength='40' required>\n            <small class='feedbacks'>\n                <span class='feedback valid'>Переклад введено правильно!</span>\n                <span class='feedback invalid' data-default-feedback='Введіть переклад!'>Введіть переклад!</span>\n            </small>\n        </label>\n    `;l.O3.id++,l.O3.count++,C.insertAdjacentHTML("beforeend",t),C.lastElementChild.focus(),(0,s.G9)(l.O3.count)}const O=document.querySelector(".form__add-single-word"),q=document.querySelector(".translates__container");function N(e){e.target.classList.contains("input-delete")&&function(e){(0,s.vX)(l.cj,(()=>{var t;t=e.target.dataset.deleteId,O.querySelector(`[data-delete-id='${t}']`).remove(),l.O3.count--,(0,s.G9)(l.O3.count),E(O)}))}(e)}var F=n(8051);const I=function(){y.addEventListener("input",(0,s.Ds)(A,100)),y.addEventListener("submit",x),y.addEventListener("reset",S),document.querySelector("#add-translate").addEventListener("click",w),q.addEventListener("click",N),(0,F.H)()};function M(){i.T.isEmpty()||(i.T.clear(),(0,a.K)())}function D(){(0,s.vX)(l.ft,M)}function R(e){(0,s.mv)(e.target,D)}class Z{constructor(e,t){this.input=e,this.label=t,this.setInvalid()}setValid(e="Все добре!"){(0,o.TK)(this.input,e,this.label.nextElementSibling),this.label.classList.replace("invalid","valid")}setInvalid(e="Завантажте текстовий файл!"){(0,o.KB)(this.input,e,this.label.nextElementSibling),this.label.classList.replace("valid","invalid")}reset(e){(0,s.TL)(this.input),this.setInvalid(e)}resetConfirm(e){(0,s.vX)(l.Wx,e)}}class k{constructor(e){this.container=e,this.title=this.container.querySelector(".title"),this.content=this.container.querySelector(".content"),this.content.style.height=0}hide(){this.container.classList.add("hidden"),this.slideUp()}show(){this.container.classList.remove("hidden")}isOpen(){return this.container.classList.contains("open")}slideToggle(){this.isOpen()?this.slideUp():this.slideDown()}slideDown(){if(!this.content.children.length)return;this.container.classList.add("open");const e=this.#e()+"px";this.content.style.height=e,this.content.animate([{height:0},{height:e}],{duration:this.#t()})}slideUp(){this.container.classList.remove("open"),this.content.style.height=0,this.content.animate([{height:this.#e()+"px"},{height:0}],{duration:this.#t()})}#e(){const e=this.content.children,t=e.length;return t?e[0].offsetHeight*t:0}#t(){return 300+this.#e()/(this.content.children.length+1)}}class H extends Z{constructor(e,t){super(e,t),this.#n()}incrementFilesCount(){const e=this.uploadedFilesCountContainer,t=Number(e.textContent);e.textContent=t+1}appendValidFile(e,t){this.uploadedFilesContainer.innerHTML+=`\n            <small class='uploaded__file success'>\n                <i class='icon fa-solid fa-file'></i>\n                Слова з файлу <b>${e.name}</b> готові до додавання у розділ! (Кількість слів: <b>${t}</b>)\n            </small>`,this.incrementFilesCount()}appendInvalidFile(e,t){this.uploadedFilesContainer.innerHTML+=`\n            <small class='uploaded__file fail'>\n                <i class='icon fa fa-times' aria-hidden='true'></i>\n                Файл <b>${e.name}</b> не був завантажений через помилку: ${t}\n            </small>`,this.incrementFilesCount()}reset(e){this.uploadedFilesContainer.innerHTML="",this.uploadedFilesCountContainer.textContent=0,this.toggler.hide(),super.reset(e)}#n(){const e=this.label.nextElementSibling,t=document.createElement("div");t.classList.add("uploaded-files","toggler","hidden");const n=document.createElement("button");n.type="button",n.classList.add("title","uploaded-files__title");const i=document.createElement("span");i.classList.add("uploaded-files__count"),i.textContent=0,n.append(i),i.insertAdjacentHTML("beforebegin","Завантажені файли ("),i.insertAdjacentHTML("afterend",') <i class="caret fas fa-angle-down"></i>');const s=document.createElement("div");s.classList.add("content","uploaded-files__info"),t.append(n),t.append(s),e.after(t),this.uploadedFilesContainer=s,this.uploadedFilesCountContainer=i,this.toggler=new k(t),this.toggler.title.addEventListener("click",(()=>this.toggler.slideToggle()))}}var K=n(9388);class X extends K.Z{constructor(e){super(e,"loader")}}const j=new X(document.querySelector(".loader"));function P(e,t=":"){return new Promise(((n,i)=>{n(e.map(((e,n)=>{const a=n+1;e.includes(t)||i(l.Zj.NO_SEPARATOR_IN_ROW(t,a));const[o,r]=e.split(t),c=o.trim().replaceAll(",","");c||i(l.Zj.NO_WORD_IN_ROW(a));const d=r.trim();d||i(l.Zj.NO_TRANSLATES_IN_ROW(a));const u=d.split(",").map((e=>e.trim())).filter(Boolean);return u.includes(c)&&i(l.Zj.WORD_AND_TRANSLATE_ARE_SAME(a)),(0,s.el)(u).length!==u.length&&i(l.Zj.TRANSLATES_ARE_SAME(a)),{word:c,translates:u}})))}))}const U=["dragenter","dragover"],$=["dragleave","drop"];function B(){this.classList.add("dragged-over")}function G(){this.classList.remove("dragged-over")}function W(e,t){document.querySelectorAll(".file-input-label").forEach((n=>{n.addEventListener(e,(0,s.Ds)(t,100))}))}const V=async()=>{const e=await(0,s.xu)("import-templates/text.txt"),{text:t,separator:n}=(e=>{const t=document.querySelector(".form__import-txt"),n=(0,s.ZN)(t.separators);return{separator:n,text:e.replaceAll("&",n)}})(e),i=`*** Це шаблон коректного словника з вибраним роздільником ${n}\n*** Якщо хочете завантажити цей шаблон у словник, то видаліть текст із зірочками на початку\n*** [слово] ${n} [переклад1], [переклад2], ...\n${t}`;(0,s.WH)("template",i)},Y=function(){U.forEach((e=>W(e,B))),$.forEach((e=>W(e,G))),(()=>{const e=document.querySelector(".form__import-txt"),t=e.fileInput,n=e.querySelector(".file-input-label"),r=new H(t,n),c=[],d=e=>{c.length=0,r.reset(e)},u=async()=>{const t=(0,s.ZN)(e.groups),n=(0,l.sb)(t,c.length);(0,s.vX)(n,(()=>{j.open(),setTimeout((()=>{const n=c.map((e=>({...e,group:t})));i.T.addManyAsync(n).then((()=>i.T.print())).finally((()=>{i.T.save(),j.close()})),(0,s.Fx)(e),d(),(0,a.K)()}),500)}))};t.addEventListener("change",(t=>{const n=[...t.target.files];n.length?(async t=>{let n=0;const i=(0,s.ZN)(e.separators);for(const e of t)try{const{extension:t}=(0,s.x2)(e.name);if("txt"!==t)throw l.Zj.WRONG_FILE_EXTENSION;const a=await(0,s.vZ)(e);if(!a.trim())throw l.Zj.EMPTY_FILE;if(a.includes("***"))throw l.Zj.TEMPLATE_LOAD;const o=a.replace(/\r/g,"").split("\n").filter((e=>e.trim())),d=await P(o,i);c.push(...d),r.appendValidFile(e,d.length),n++}catch(t){r.appendInvalidFile(e,t)}return n})(n).then((e=>{r.toggler.hide(),c.length>0?r.setValid(o.NX.SUCCESSFULL_LOAD(e,n.length)):r.setInvalid(o.NX.TEMPLATE_MISMATCH_ERROR)})).finally((()=>r.toggler.show())):d(o.NX.LOAD_CANCELED)})),e.querySelector("#import-txt-file-reset").addEventListener("click",(()=>r.resetConfirm(d))),e.addEventListener("submit",(e=>{(0,s.mv)(e.target,u)}))})(),document.querySelector("#download-txt-template").addEventListener("click",V)};function z(){document.querySelectorAll(".form").forEach((e=>{const{colorValidate:t}=e.dataset;void 0!==t&&function(e){e.addEventListener("submit",(e=>e.target.classList.add("validated")))}(e),function(e){e.addEventListener("submit",(e=>e.preventDefault()))}(e)})),I(),document.querySelector(".form__vocabulary-clear").addEventListener("submit",R),Y(),r.addEventListener("input",(0,s.Ds)(d,100)),r.addEventListener("submit",h),m.addEventListener("submit",f)}}}]);